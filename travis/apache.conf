<VirtualHost *:8888>

    DirectoryIndex index.php index.html

    DocumentRoot %TRAVIS_BUILD_DIR%/client/build
    Alias /api %TRAVIS_BUILD_DIR%/server/public

    SetEnv APP_DEBUG true
    SetEnv TESTING true
    SetEnv DB_CONNECTION mysql_testing

    ErrorLog /var/log/apache2/error.log
    CustomLog /var/log/apache2/access.log common
    RewriteLog /var/log/apache2/rewrite.log
    RewriteLogLevel 10

    <Directory %TRAVIS_BUILD_DIR%/client/build>
        Options Indexes FollowSymLinks
        DirectoryIndex index.html
        FallbackResource /index.html
        AllowOverride all
        Order allow,deny
        Allow from all
    </Directory>

    <Directory %TRAVIS_BUILD_DIR%/server/public>
        # Wire up Apache to use Travis CI's php-fpm.
        AddHandler php5-fcgi .php
        Action php5-fcgi /php5-fcgi
        Alias /php5-fcgi /usr/lib/cgi-bin/php5-fcgi
        FastCgiExternalServer /usr/lib/cgi-bin/php5-fcgi -host 127.0.0.1:9000 -pass-header Authorization

        Options Indexes FollowSymLinks MultiViews ExecCGI
        AllowOverride all

        Order allow,deny
        Allow from all
    </Directory>

</VirtualHost>

Listen 8888
